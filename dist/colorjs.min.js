/* 
 * colorjs - A simple JavaScript library to manage colors 
 * Copyright(c) GermÃ¡n Franco 2017 (License: LGPL-3.0) 
 * 03-12-2017 - Version: 0.2.0 
 */
var colorjs=function(t){function e(t){switch(t){case"rgb":this.setRGB(arguments[1],arguments[2],arguments[3]);break;case"hsv":this.setHSV(arguments[1],arguments[2],arguments[3]);break;case"hex":default:this.setHEX(arguments[1])}}function h(t,e){return e.length>=t.length?e:t.substr(0,t.length-e.length)+e}function n(t,e,h){if(t.length>256)throw"Palette list too long: max is 256";this.palette=t,this.title=e,this.comment=h}var i={};return e.prototype={setRGB:function(t,e,h){this._red=255&t,this._green=255&e,this._blue=255&h,this.onRGBChange()},setHSV:function(t,e,h){t<0||isNaN(t)?t=0:t>360&&(t=360),e<0||isNaN(e)?e=0:e>1&&(e=1),h<0||isNaN(h)?h=0:h>1&&(h=1),this._hue=t,this._sat=e,this._val=h,this.onHSVChange()},setHEX:function(t){this._hex="number"==typeof t?16777215&t:"string"==typeof t?function(t){if("#"===t[0]&&(t=t.substring(1)),3===t.length)t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2];else if(t.length>6)return 16777215;return parseInt(t,16)||0}(t):0,this.onHEXChange()},get red(){return this._red},set red(t){this._red=255&t,this.onRGBChange()},get green(){return this._green},set green(t){this._green=255&t,this.onRGBChange()},get blue(){return this._blue},set blue(t){this._blue=255&t,this.onRGBChange()},get hue(){return this._hue},set hue(t){t<0||isNaN(t)?t=0:t>360&&(t=360),this._hue=t,this.onHSVChange()},get sat(){return this._sat},set sat(t){t<0||isNaN(t)?t=0:t>1&&(t=1),this._sat=t,this.onHSVChange()},get val(){return this._val},set val(t){t<0||isNaN(t)?t=0:t>1&&(t=1),this._val=t,this.onHSVChange()},get hex(){return this._hex},set hex(t){this.setHEX(t)},equals:function(t){return t&&t._hex===this._hex},clone:function(){return new e("hex",this._hex)},invert:function(){this._hex=16777215&~this._hex,this.onHEXChange()},toWebSafe:function(){this._red=51*Math.round(this._red/51),this._green=51*Math.round(this._green/51),this._blue=51*Math.round(this._blue/51),this.onRGBChange()},onRGBChange:function(){this._RGBtoHSV(),this._RGBtoHEX()},onHSVChange:function(){this._HSVtoRGB(),this._RGBtoHEX()},onHEXChange:function(){this._HEXtoRGB(),this._RGBtoHSV()},_RGBtoHSV:function(){const t=Math.max(this._red,this._green,this._blue),e=t-Math.min(this._red,this._green,this._blue);if(e>0){let h=0;t===this._red?(h=(this._green-this._blue)/e%6)<0&&(h+=6):h=t===this._green?(this._blue-this._red)/e+2:(this._red-this._green)/e+4,this._hue=60*h,this._sat=e/t,this._val=t/255}else this._hue=0,this._sat=0,this._val=t/255},_RGBtoHEX:function(){this._hex=this._red<<16|this._green<<8|this._blue},_HSVtoRGB:function(){let t,e,h;const n=this._val*this._sat,i=n*(1-Math.abs(this._hue/60%2-1)),s=this._val-n;this._hue<60?(t=n,e=i,h=0):this._hue<120?(t=i,e=n,h=0):this._hue<180?(t=0,e=n,h=i):this._hue<240?(t=0,e=i,h=n):this._hue<300?(t=i,e=0,h=n):(t=n,e=0,h=i),this._red=Math.round(255*(t+s)),this._green=Math.round(255*(e+s)),this._blue=Math.round(255*(h+s))},_HEXtoRGB:function(){this._red=this._hex>>16&255,this._green=this._hex>>8&255,this._blue=255&this._hex},toStringRGB:function(){return`rgb(${this._red},${this._green},${this._blue})`},toStringHSV:function(){return`hsv(${this._hue},${this._sat},${this._val})`},toStringHEX:function(t){return!1===t?h("000000",this._hex.toString(16)):h("#000000",this._hex.toString(16))},toString:function(){return this.toStringHEX(!0)}},e.random=function(){return new e("hex",function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}(0,16777215))},i.Color=e,t.Color=e,n.prototype={save:function(){const t=this.toString(),e=this.title.replace(" ","_").toLowerCase()+".gpl";try{!function(t,e){let h=document.createElement("a");h.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),h.setAttribute("download",t),h.style.display="none",document.body.appendChild(h),h.click(),document.body.removeChild(h)}(e,t)}catch(t){throw"Failed downloading the file: witchery didn't work"}},toString:function(){let t="GIMP Palette\n";t+="Name: "+this.title+"\n",t+="Columns: 8\n",this.comment&&(t+="#"+this.comment+"\n"),t+="\n";for(var e=0;e<this.palette.length;e++)t+=this.colorToGPL(this.palette[e])+"\n";return t},colorToGPL:function(t,e){return e=e||t.toStringHEX(),h("    ",t.red+" ")+h("    ",t.green+" ")+h("    ",t.blue+" ")+e}},i.GPLPalette=n,t.GPLPalette=n,i}(window);